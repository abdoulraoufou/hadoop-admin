# 6 machines virtuelles debian wheezy. 1 machine maitre (NameNode) et 5 machines esclaves (DataNode). 

# Paramétrer le fichier /etc/hosts de chaque noeud
sudo nano /etc/hosts

# Ajouter le code suivant dans le fichier /etc/hosts
"""
<IP> abdoop-cluster-maitre # par exemple: 130.211.166.44 abdoop-cluster-maitre
<IP> abdoop-cluster-slave1
<IP> abdoop-cluster-slave2
<IP> abdoop-cluster-slave3
<IP> abdoop-cluster-slave4
<IP> abdoop-cluster-slave5
"""

# Ajouter l'utilisateur hadoopmanager
sudo adduser hadoopmanager # mot de passe: hadoop

# Générer une clé ssh pour pouvoir ouvrir une session sur le noued sans fournir le mot de passe
ssh-keygen -t rsa -P ""

# Ajouter la clé publique à la liste des clés acceptées
cat ~/.ssh/id_rsa.pub >> ~/.ssh/authorized_keys

# Copie de la clé publique sur les machines du cluster
ssh-copy-id -i ~/.ssh/id_rsa.pub hadoopmanager@abdoop-cluster-slave1

# Désactiver le mot de passe du compte utilisateur hadoopmanager
sudo nano /etc/sudoers
# Ajouter ce code dans le fichier /etc/sudoers
"""
hadoopmanager     ALL=NOPASSWD: ALL
araoufougambo_netbooster_com ALL=NOPASSWD: ALL
"""

# tester la connexion ssh claasique sur gce
ssh hadoopmanager@abdoop-cluster-maitre

# Ajouter une clé ssh dans les metadonnées gce
gcloud auth login
gcloud compute ssh hadoopmanager@abdoop-cluster-maitre

# Configuer un acces ssh classique sur gce
eval `ssh-agent`
ssh-add ~/.ssh/google_compute_engine

#--------------------------------------------------------#
#- Installation et configuration d'un cluster multinœud -#
#--------------------------------------------------------#
# Installation Cloudera Manager dans abdoop-cluster-maitre
wget http://archive-primary.cloudera.com/cm5/installer/5.1.2/cloudera-manager-installer.bin

# Modifier les droits afin d'autoriser l'exécution puis exécuter le binaire en root
chmod u+x cloudera-manager-installer.bin
sudo ./cloudera-manager-installer.bin

# Installation d'un cluster trois nœuds


